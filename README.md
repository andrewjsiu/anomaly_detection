# Anomaly Detection

This repository includes my code in Python 3.6 to implement the feature of detecting a significantly large purchase compared to previous  purchases made by one's social network. The purpose is to help the e-commerce company flag up these large purchases for their friends to see, hoping that they will be influenced to make similarly large purchases. See the original challenge summary posed by [Insight Data Science](https://github.com/InsightDataScience/anomaly_detection).

My approach is to first create a social network graph, which is characterized as a set of user ids and a set of edges that indicate first-degree friendships. There are many ways to represent this graph in Python, but I think the most efficient way is to create a dictionary mapping each user id to a set of his first-degree friends' user ids. It will then only take one step to find all the first-degree neighbors of a given user. Based on this network graph, I can find the set of all second-degree friends by looping through the user's first-degree friends and collecting all of the their first-degree friends (not including the user himself of course). Similarly, all friends within three degrees of separation are found by looping through one's second-degree friends and collecting all their first-degree friends. We can do this for any higher-degree of separation, but research has shown that almost everyone is found within 6 degrees of separation. 

As new events stream in from active users, I update the existing social network graph if the event is 'befriend' or 'unfriend' and append the new purchase data to the `Pandas` dataframe of all purchases. Given a buyer's purchase event, `pandas` allows me to select all previous purchases made by any neighbor within `D` degrees of separation to the buyer. I then compute the mean and standard deviation of the `T` most recent purchases made within this buyer's social network. The next step is to detect and flag up any purchases that are more than 3 standard deviations above the mean and save them in the output file as `flagged_purchases.json`. The hope is that showing certain buyers' significantly large purcahses to their friends will increase sales through peer influence. 
