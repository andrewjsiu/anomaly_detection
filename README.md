# Anomaly Detection

This repository includes my code in Python 3.6 to implement the feature of detecting a significantly large purchase compared to previous  purchases made by one's social network. The purpose is to help the e-commerce company flag up these large purchases for their friends to see, hoping that they will be influenced to make similar purchases. See the original challenge summary posed by [Insight Data Science](https://github.com/InsightDataScience/anomaly_detection).

My approach is to first create a social network graph, which is characterized as a set of user ids and a set of edges that indicate first-degree friendships. There are many ways to represent this graph in Python, but I think the most efficient way is to create a dictionary that maps each user id to a set of first-degree friends' user ids. It will then only take one step to find all the first-degree neighbors of a given user. Based on this network graph, I can find the set of all second-degree friends by looping through a user's first-degree friends and collecting all of the their first-degree friends (excluding the user himself of course). Similarly, all friends within three degrees of separation are found by looping through one's second-degree friends and collecting all their first-degree friends. We can do this for all higher-degree of separation, but almost all people can be found within 5 or 6 degrees of separation. 

As new events stream in from the users, I update the existing social network graph if the event is 'befriend' or 'unfriend' and append the new purchase data to the `Pandas` dataframe of all purchases. `Pandas` allows me to select all purchases made by a user's friends within `D` degrees of separation. I then compute the mean and standard deviation of the `T` most recent purchases made within this social network. I flag up any purchase that is more than 3 standard deviations above the mean and write in the output file called `flagged_purchases.json`.
